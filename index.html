<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="سفارشی‌سازی و خرید ست‌های سنگ مصنوعی با انتخاب مدل و رنگ دلخواه">
    <title>ست سنگ مصنوعی - سازنده ست</title>
    <script src="https://telegram.org/js/telegram-web-app.js?59"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<header class="fixed-header">
    <div class="header-content">
        <h1> سنگین کالکشن </h1>
        <img src="assetst/images/5-removebg-preview.png" alt="لوگوی سنگین کالکشن" class="logo">
    </div>
</header>
<div class="stage-toolbar" id="stage-toolbar">
    <nav role="tablist" class="product-nav">
        <div class="nav-items-wrapper" id="nav-items-wrapper"></div>
    </nav>
</div>

<main id="main-content">
    <section class="stage welcome-stage active" id="stage-welcome">
        <h1>به دنیای سنگ مصنوعی خوش آمدید!</h1>
        <img src="assets/images/100911-ezgif.com-video-to-gif-converter (1).gif" alt="ست سنگ مصنوعی" class="welcome-image">
        <p>ست محصولات سنگ مصنوعی خود را بسازید. از سینی تا مجسمه، همه چیز را انتخاب کنید و فضایی منحصر به فرد برای خود ایجاد کنید.</p>
    </section>
    <button class="welcome-start-btn" id="start-button">شروع</button>

    <section id="stage-review" class="stage">
        <div class="stage-content">
            <h1>بازبینی نهایی سفارش</h1>
            <p>لطفاً محصولات انتخابی خود را بررسی کنید</p>
            
            <!-- این ظرف (container) برای کارت‌ها اضافه شده است -->
            <div id="review-cards-container" class="review-cards-grid">
                <!-- کارت‌ها به صورت داینامیک در اینجا قرار می‌گیرند -->
            </div>

            <div class="review-summary">
                <div class="summary-total">
                    <span>جمع کل:</span>
                    <span id="total-price">0 تومان</span>
                </div>
            </div>
        </div>
    </section>

    <div class="stage-navigation" id="nav-review">
        <button class="btn-nav btn-previous" id="nav-review-previous-btn"><i class="fas fa-arrow-right"></i></button>
        <button class="btn-nav btn-review" id="nav-review-submit-btn">ارسال سفارش</button>
    </div>
    <div id="navigation-container" class="navigation-container"></div>
</main>

<aside role="complementary" class="sidebar-cart" id="sidebar-cart" aria-label="سبد خرید">
    <div class="sidebar-header">
        <h2><i class="fas fa-shopping-cart"></i> سبد خرید شما <button class="btn-small" id="sidebar-close-btn" aria-label="بستن سبد خرید"><i class="fas fa-times"></i></button></h2>
    </div>
    <div class="sidebar-content">
        <div class="selected-items-summary" id="selected-items-summary"></div>
    </div>
    <div class="sidebar-footer">
        <div class="total-summary">مجموع آیتم‌ها: <span id="total-items-count">0</span></div>
        <button class="btn-primary" id="final-submit-btn">بازبینی و تأیید نهایی</button>
    </div>
</aside>

<button class="floating-cart-btn" id="floating-cart-btn" aria-label="باز کردن سبد خرید">
    <i class="fas fa-shopping-cart"></i>
    <span class="cart-badge" id="cart-badge">0</span>
</button>

<div id="color-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-product-name">
    <div class="modal-content">
        <h3 id="modal-product-name">انتخاب رنگ</h3>
        <div class="modal-product-preview" id="modal-product-preview">
            <div class="carousel-container" id="carousel-container">
                <div class="carousel-inner" id="carousel-inner"></div>
            </div>
            <button class="carousel-arrow left" id="carousel-arrow-left"><i class="fas fa-chevron-left"></i></button>
            <button class="carousel-arrow right" id="carousel-arrow-right"><i class="fas fa-chevron-right"></i></button>
        </div>
        <p class="color-info">برای اضافه کردن محصول ابتدا رنگ را انتخاب کنید</p>
        <div class="color-options" id="color-options"></div>
        <div class="buttons">
            <button class="btn-primary" id="color-modal-confirm-btn">تأیید انتخاب</button>
            <button class="btn-secondary" id="color-modal-cancel-btn">انصراف</button>
        </div>
    </div>
</div>

<div id="delete-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title">
    <div class="modal-content">
        <h3 id="delete-modal-title">تأیید حذف</h3>
        <p>آیا از حذف این محصول از سبد خرید مطمئن هستید؟</p>
        <div class="buttons">
            <button class="btn-danger btn-small" id="confirm-delete-btn">بله، حذف شود</button>
            <button class="btn-secondary btn-small" id="delete-modal-cancel-btn">انصراف</button>
        </div>
    </div>
</div>


<div id="edit-product-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="edit-product-title">
    <div class="modal-content edit-product-modal-content">
        <div class="modal-header">
            <h3 id="edit-product-title">ویرایش محصول</h3>
            <button class="close-modal-btn" id="close-edit-product-modal-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div id="edit-product-content" class="edit-product-content">
                <!-- کارت‌های رنگ به صورت داینامیک در اینجا قرار می‌گیرند -->
            </div>
        </div>
    </div>
</div>

<!-- کد جدید برای مودال ویرایش تعداد -->
<div id="edit-quantity-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="edit-quantity-title">
    <div class="modal-content">
        <h3 id="edit-quantity-title">ویرایش تعداد و رنگ‌ها</h3>
        <p id="edit-item-info"></p>
        
        <!-- این بخش جدید است: لیستی برای نمایش رنگ‌ها -->
        <div id="edit-colors-list" class="edit-colors-list"></div>

        <div class="buttons">
            <button class="btn-secondary" id="edit-quantity-modal-cancel-btn">انصراف</button>
        </div>
    </div>
</div>

<!-- کد جدید برای مودال پیش‌نمایش تصویر -->
<div id="image-preview-modal" class="modal-overlay" role="dialog" aria-modal="true">
    <div class="modal-content image-preview-content">
        <button class="close-preview-btn" id="close-preview-btn"><i class="fas fa-times"></i></button>
        <div class="preview-carousel-container" id="preview-carousel-container">
            <div class="preview-carousel-inner" id="preview-carousel-inner"></div>
            <button class="carousel-arrow left" id="preview-arrow-left"><i class="fas fa-chevron-right"></i></button>
            <button class="carousel-arrow right" id="preview-arrow-right"><i class="fas fa-chevron-left"></i></button>
        </div>
        <div class="preview-image-info" id="preview-image-info"></div>
    </div>
</div>

<button class="scroll-top-btn" id="scroll-top-btn" title="برگشت به بالا" style="display: none;">
    <i class="fas fa-arrow-up"></i>
</button>
<!-- مودال تایید نهایی سفارش -->
<div id="submit-order-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="submit-order-modal-title">
    <div class="modal-content">
        <h3 id="submit-order-modal-title">تأیید نهایی سفارش</h3>
        <p>آیا از ارسال سفارش خود مطمئن هستید؟</p>
        <div class="buttons">
            <button class="btn-primary" id="confirm-submit-order-btn">بله، ارسال شود</button>
            <button class="btn-secondary" id="cancel-submit-order-btn">انصراف</button>
        </div>
    </div>
</div>

<!-- مودال سبد خرید خالی -->
<div id="empty-cart-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="empty-cart-modal-title">
    <div class="modal-content">
        <h3 id="empty-cart-modal-title">سبد خرید خالی است!</h3>
        <p>شما هیچ محصولی را به سبد خرید خود اضافه نکرده‌اید.</p>
        <div class="buttons">
            <button class="btn-primary" id="empty-cart-modal-ok-btn">باشه</button>
        </div>
    </div>
</div>

<!-- مودال خطا در ارسال سفارش -->
<div id="order-error-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="order-error-modal-title">
    <div class="modal-content">
        <h3 id="order-error-modal-title">خطا در ارسال سفارش</h3>
        <p>متأسفانه در ارسال سفارش شما مشکلی پیش آمد. لطفاً دوباره تلاش کنید.</p>
        <div class="buttons">
            <button class="btn-primary" id="retry-order-btn">تلاش مجدد</button>
        </div>
    </div>
</div>

<script type="module" src="js/config.js"></script>
<script type="module" src="js/utils.js"></script>
<script type="module" src="js/cart-manager.js"></script>
<script type="module" src="js/ui-components.js"></script>
<script type="module" src="js/product-manager.js"></script>
<script type="module" src="js/app.js"></script>
</body>
</html>
